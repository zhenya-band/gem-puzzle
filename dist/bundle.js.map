{"version":3,"file":"bundle.js","sources":["webpack://gem-puzzle/bundle.js"],"sourcesContent":["(()=>{\"use strict\";function t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(\"undefined\"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],s=!0,o=!1,h=void 0;try{for(var n,r=t[Symbol.iterator]();!(s=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);s=!0);}catch(t){o=!0,h=t}finally{try{s||null==r.return||r.return()}finally{if(o)throw h}}return i}}(t,e)||s(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function e(t){return(e=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function s(t,e){if(t){if(\"string\"==typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===i&&t.constructor&&(i=t.constructor.name),\"Map\"===i||\"Set\"===i?Array.from(t):\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=new Array(e);i<e;i++)s[i]=t[i];return s}function h(s,o,h,n){var r,a=null;try{a=document.createElement(s)}catch(t){throw new Error(\"Invalid tag name\")}o&&(r=a.classList).add.apply(r,i(o.split(\" \"))),h&&Array.isArray(h)?h.forEach((function(t){return t&&a.appendChild(t)})):h&&\"object\"===e(h)?a.appendChild(h):h&&\"string\"==typeof h&&(a.innerHTML=h),n&&n.appendChild(a);for(var l=arguments.length,u=new Array(l>4?l-4:0),c=4;c<l;c++)u[c-4]=arguments[c];return u.length&&u.forEach((function(e){var i=t(e,2),s=i[0],o=i[1];\"\"===o?a.setAttribute(s,\"\"):s.match(/value|id|placeholder|cols|rows|autocorrect|spellcheck/)?a.setAttribute(s,o):a.dataset[s]=o})),a}function n(t){return(parseInt(t,10)<10?\"0\":\"\")+t}function r(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var a=function(){function t(e,i,s){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.ctx=e,this.grid=i,this.img=s}var e,i;return e=t,(i=[{key:\"clear\",value:function(){this.ctx.fillStyle=\"gray\",this.ctx.fillRect(0,0,400,400)}},{key:\"render\",value:function(t,e){this.clear();for(var i=0;i<t.length;i++){var s=t[i],o=this.grid.getPositionByValue(s.value),h=400/e,n=900/e/h;this.ctx.drawImage(this.img,o.x*n,o.y*n,h*n,h*n,s.x,s.y,h,h)}}}])&&r(e.prototype,i),t}();function l(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var u=function(){function t(e,i,s,o){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.gameWidth=e,this.gameHeight=i,this.blockWidth=s,this.blockHeight=o}var e,i;return e=t,(i=[{key:\"getPositionByValue\",value:function(t){return{x:(t-1)%this.gameWidth*this.blockWidth,y:Math.floor((t-1)/this.gameWidth)*this.blockHeight}}}])&&l(e.prototype,i),t}();function c(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var f=function(){function t(e,i,s,o,h,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.x=e,this.y=i,this.targetX=e,this.targetY=i,this.value=s,this.width=o,this.height=h,this.dx=n,this.dy=r}var e,i;return e=t,(i=[{key:\"tick\",value:function(){if(this.targetX>this.x)this.x+=this.dx,this.x>this.targetX&&(this.x=this.targetX);else if(this.targetX<this.x)this.x-=this.dx,this.x<this.targetX&&(this.x=this.targetX);else if(this.targetY>this.y)this.y+=this.dy,this.y>this.targetY&&(this.y=this.targetY);else{if(!(this.targetY<this.y))return!1;this.y-=this.dy,this.y<this.targetY&&(this.y=this.targetY)}return!0}},{key:\"incTargetX\",value:function(){this.targetX+=this.width}},{key:\"decTargetX\",value:function(){this.targetX-=this.width}},{key:\"incTargetY\",value:function(){this.targetY+=this.height}},{key:\"decTargetY\",value:function(){this.targetY-=this.height}}])&&c(e.prototype,i),t}();function v(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var d=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.gameState=e,this.viewState=[],this.animationQueue=[];for(var s=0;s<this.gameState.length;s++)for(var o=0;o<e[s].length;o++)if(0!==this.gameState[s][o]){var h=400/i;this.viewState.push(new f(o*h,s*h,this.gameState[s][o],h,h,12,12))}}var e,i;return e=t,(i=[{key:\"tick\",value:function(t){for(var e=!1,i=0;i<this.viewState.length;i++)t?e=e||this.viewState[i].tick():this.viewState[i].tick();if(!e&&this.animationQueue.length>0){var s=this.animationQueue.shift();switch(s[0]){case\"right\":this.viewState[s[1]].incTargetX();break;case\"left\":this.viewState[s[1]].decTargetX();break;case\"down\":this.viewState[s[1]].incTargetY();break;case\"up\":this.viewState[s[1]].decTargetY()}}}},{key:\"toRight\",value:function(t,e){e?this.animationQueue.push([\"right\",t-1]):this.viewState[t-1].incTargetX()}},{key:\"toLeft\",value:function(t,e){e?this.animationQueue.push([\"left\",t-1]):this.viewState[t-1].decTargetX()}},{key:\"toDown\",value:function(t,e){e?this.animationQueue.push([\"down\",t-1]):this.viewState[t-1].incTargetY()}},{key:\"toUp\",value:function(t,e){e?this.animationQueue.push([\"up\",t-1]):this.viewState[t-1].decTargetY()}},{key:\"getState\",value:function(){return this.viewState}}])&&v(e.prototype,i),t}();function y(t){this.grid=[],this.fixed=[],this.numbers=[],this.solution=[],this.originalGrid=t}function m(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}y.prototype.setupSolver=function(){this.numbers=[],this.fixed=[],this.grid=[];for(var t=0;t<this.originalGrid.length;t++){this.fixed[t]=[],this.grid[t]=[];for(var e=0;e<this.originalGrid.length;e++){var i=this.originalGrid[t][e];this.grid[t][e]=i,this.fixed[t][e]=!1,this.numbers[i]={x:e,y:t}}}},y.prototype.solve=function(){this.setupSolver();try{this.solveGrid(this.grid.length)}catch(t){return null}return this.solution},y.prototype.solveGrid=function(t){t>2?(this.solveRow(t),this.solveColumn(t),this.solveGrid(t-1)):2===t&&(this.solveRow(t),0===this.grid[this.grid.length-1][this.grid.length-t]&&this.swapE({x:this.grid.length-1,y:this.grid.length-1}))},y.prototype.solveRow=function(t){for(var e=this.grid.length-t,i=e;i<this.grid.length-2;i++){var s=e*this.grid.length+(i+1);this.moveNumberTowards(s,{x:i,y:e}),this.fixed[e][i]=!0}var o=e*this.grid.length+this.grid.length-1,h=o+1;if(this.moveNumberTowards(o,{x:this.grid.length-1,y:e}),this.moveNumberTowards(h,{x:this.grid.length-1,y:e+1}),this.numbers[o].x!==this.grid.length-1||this.numbers[o].y!==e||this.numbers[h].x!==this.grid.length-1||this.numbers[h].y!==e+1){this.moveNumberTowards(o,{x:this.grid.length-1,y:e}),this.moveNumberTowards(h,{x:this.grid.length-2,y:e}),this.moveEmptyTo({x:this.grid.length-2,y:e+1});var n={x:this.grid.length-1,y:e+1};this.applyRelativeMoveList(n,[\"ul\",\"u\",\"\",\"l\",\"dl\",\"d\",\"\",\"l\",\"ul\",\"u\",\"\",\"l\",\"ul\",\"u\",\"\",\"d\"])}this.specialTopRightRotation(e)},y.prototype.solveColumn=function(t){for(var e=this.grid.length-t,i=e;i<this.grid.length-2;i++){var s=i*this.grid.length+1+e;this.moveNumberTowards(s,{x:e,y:i}),this.fixed[i][e]=!0}var o=(this.grid.length-2)*this.grid.length+1+e,h=o+this.grid.length;if(this.moveNumberTowards(o,{x:e,y:this.grid.length-1}),this.moveNumberTowards(h,{x:e+1,y:this.grid.length-1}),this.numbers[o].x!==e||this.numbers[o].y!==this.grid.length-1||this.numbers[h].x!==e+1||this.numbers[h].y!==this.grid.length-1){this.moveNumberTowards(o,{x:e,y:this.grid.length-1}),this.moveNumberTowards(h,{x:e,y:this.grid.length-2}),this.moveEmptyTo({x:e+1,y:this.grid.length-2});var n={x:e+1,y:this.grid.length-1};this.applyRelativeMoveList(n,[\"ul\",\"l\",\"\",\"u\",\"ur\",\"r\",\"\",\"u\",\"ul\",\"l\",\"\",\"u\",\"ul\",\"l\",\"\",\"r\"])}this.specialLeftBottomRotation(e)},y.prototype.applyRelativeMoveList=function(t,e){for(var i=0;i<e.length;i++)0===e[i]?this.swapE(t):this.swapE(this.offsetPosition(t,e[i]))},y.prototype.moveNumberTowards=function(t,e){if(this.numbers[t].x!==e.x||this.numbers[t].y!==e.y)for(this.makeEmptyNeighborTo(t);this.numbers[t].x!==e.x||this.numbers[t].y!==e.y;){var i=this.getDirectionToProceed(t,e);if(!this.areNeighbors(t,0))throw new Error(\"cannot rotate without empty\");\"u\"===i||\"d\"===i?this.rotateVertical(t,\"u\"===i):this.rotateHorizontal(t,\"l\"===i)}},y.prototype.rotateHorizontal=function(t,e){var i=e?\"l\":\"r\",s=e?\"r\":\"l\",o=this.numbers[0],h=this.numbers[t];if(o.y!==h.y){var n=o.y<h.y?\"u\":\"d\";this.moveable(this.offsetPosition(h,n+i))&&this.moveable(this.offsetPosition(h,n))?(this.swapE(this.offsetPosition(h,n+i)),this.swapE(this.offsetPosition(h,i))):(this.swapE(this.offsetPosition(h,n+s)),this.swapE(this.offsetPosition(h,s)),this.proper3By2RotationHorizontal(h,e))}else(o.x<h.x&&!e||o.x>h.x&&e)&&this.proper3By2RotationHorizontal(h,e);this.swapE(h)},y.prototype.proper3By2RotationHorizontal=function(t,e){var i=e?\"l\":\"r\",s=e?\"r\":\"l\",o=\"u\";if(this.moveable(this.offsetPosition(t,\"d\".concat(i)))&&this.moveable(this.offsetPosition(t,\"d\"))&&this.moveable(this.offsetPosition(t,\"d\".concat(s))))o=\"d\";else if(!this.moveable(this.offsetPosition(t,\"u\".concat(i)))||!this.moveable(this.offsetPosition(t,\"u\"))||!this.moveable(this.offsetPosition(t,\"u\".concat(s))))throw new Error(\"unable to move up all spots fixed\");this.swapE(this.offsetPosition(t,o+s)),this.swapE(this.offsetPosition(t,o)),this.swapE(this.offsetPosition(t,o+i)),this.swapE(this.offsetPosition(t,i))},y.prototype.rotateVertical=function(t,e){var i=e?\"u\":\"d\",s=e?\"d\":\"u\",o=this.numbers[0],h=this.numbers[t];if(o.x!==h.x){var n=o.x<h.x?\"l\":\"r\";this.moveable(this.offsetPosition(h,i+n))&&this.moveable(this.offsetPosition(h,n))?(this.swapE(this.offsetPosition(h,i+n)),this.swapE(this.offsetPosition(h,i))):(this.swapE(this.offsetPosition(h,s+n)),this.swapE(this.offsetPosition(h,s)),this.proper2By3RotationVertical(h,e))}else(o.y<h.y&&!e||o.y>h.y&&e)&&this.proper2By3RotationVertical(h,e);this.swapE(h)},y.prototype.proper2By3RotationVertical=function(t,e){var i=e?\"u\":\"d\",s=e?\"d\":\"u\",o=\"r\";if(this.moveable(this.offsetPosition(t,\"\".concat(i,\"l\")))&&this.moveable(this.offsetPosition(t,\"l\"))&&this.moveable(this.offsetPosition(t,\"\".concat(s,\"l\"))))o=\"l\";else if(!this.moveable(this.offsetPosition(t,\"\".concat(i,\"r\")))||!this.moveable(this.offsetPosition(t,\"r\"))||!this.moveable(this.offsetPosition(t,\"\".concat(s,\"r\"))))throw new Error(\"Unable to preform move, the puzzle is quite possibly unsolveable\");this.swapE(this.offsetPosition(t,s+o)),this.swapE(this.offsetPosition(t,o)),this.swapE(this.offsetPosition(t,i+o)),this.swapE(this.offsetPosition(t,i))},y.prototype.specialTopRightRotation=function(t){this.fixed[t][this.grid.length-1]=!0,this.fixed[t+1][this.grid.length-1]=!0;var e={x:this.grid.length-1,y:t};this.moveEmptyTo(this.offsetPosition(e,\"l\")),this.swapE(e),this.swapE(this.offsetPosition(e,\"d\")),this.fixed[t+1][this.grid.length-1]=!1,this.fixed[e.y][e.x-1]=!0},y.prototype.specialLeftBottomRotation=function(t){this.fixed[this.grid.length-1][t]=!0,this.fixed[this.grid.length-1][t+1]=!0;var e={x:t,y:this.grid.length-1};this.moveEmptyTo(this.offsetPosition(e,\"u\")),this.swapE(e),this.swapE(this.offsetPosition(e,\"r\")),this.fixed[this.grid.length-1][t+1]=!1,this.fixed[e.y-1][e.x]=!0},y.prototype.getDirectionToProceed=function(t,e){var i=this.numbers[t],s=e.x-i.x,o=e.y-i.y;if(s<0&&this.moveable({x:i.x-1,y:i.y}))return\"l\";if(s>0&&this.moveable({x:i.x+1,y:i.y}))return\"r\";if(o<0&&this.moveable({x:i.x,y:i.y-1}))return\"u\";if(o>0&&this.moveable({x:i.x,y:i.y+1}))return\"d\";throw new Error(\"There is no valid move, the puzzle was incorrectly shuffled\")},y.prototype.makeEmptyNeighborTo=function(t){for(var e=this.numbers[t],i=1;(this.numbers[0].x!==e.x||this.numbers[0].y!==e.y)&&!this.areNeighbors(0,t);)if(this.movingEmptyLoop(e),(i+=1)>100)throw new Error(\"Infinite loop hit while solving the puzzle, it is quite likely this puzzle is invalid\")},y.prototype.moveEmptyTo=function(t){if(this.fixed[t.y][t.x])throw new Error(\"cannot move empty to a fixed position\");for(var e=1;!(this.numbers[0].x===t.x&&this.numbers[0].y===t.y||(this.movingEmptyLoop(t),(e+=1)>100)););},y.prototype.movingEmptyLoop=function(t){var e=this.numbers[0],i=e.x-t.x,s=e.y-t.y;i<0&&this.canSwap(e,this.offsetPosition(e,\"r\"))?this.swap(e,this.offsetPosition(e,\"r\")):i>0&&this.canSwap(e,this.offsetPosition(e,\"l\"))?this.swap(e,this.offsetPosition(e,\"l\")):s<0&&this.canSwap(e,this.offsetPosition(e,\"d\"))?this.swap(e,this.offsetPosition(e,\"d\")):s>0&&this.canSwap(e,this.offsetPosition(e,\"u\"))&&this.swap(e,this.offsetPosition(e,\"u\"))},y.prototype.offsetPosition=function(t,e){return\"u\"===e?{x:t.x,y:t.y-1}:\"d\"===e?{x:t.x,y:t.y+1}:\"l\"===e?{x:t.x-1,y:t.y}:\"r\"===e?{x:t.x+1,y:t.y}:\"ul\"===e?{x:t.x-1,y:t.y-1}:\"ur\"===e?{x:t.x+1,y:t.y-1}:\"dl\"===e?{x:t.x-1,y:t.y+1}:\"dr\"===e?{x:t.x+1,y:t.y+1}:t},y.prototype.areNeighbors=function(t,e){var i=this.numbers[t],s=this.numbers[e];return 1===Math.abs(i.x-s.x)&&i.y===s.y||1===Math.abs(i.y-s.y)&&i.x===s.x},y.prototype.moveable=function(t){return this.validPos(t)&&!this.fixed[t.y][t.x]},y.prototype.validPos=function(t){return!(t.x<0||t.x>=this.grid.length||t.y<0||t.y>=this.grid.length)},y.prototype.canSwap=function(t,e){if(!this.validPos(t)||!this.validPos(e))return!1;var i=this.grid[t.y][t.x],s=this.grid[e.y][e.x];return!!this.areNeighbors(i,s)&&!(this.fixed[t.y][t.x]||this.fixed[e.y][e.x])},y.prototype.swapE=function(t){this.swap(this.numbers[0],t)},y.prototype.swap=function(t,e){var i=this.grid[t.y][t.x],s=this.grid[e.y][e.x];if(!this.areNeighbors(i,s))throw new Error(\"These numbers are not neighbors and cannot be swapped\");if(0!==i&&0!==s)throw new Error(\"You must swap with an empty space\");var o=this.numbers[i];this.numbers[i]=this.numbers[s],this.numbers[s]=o,this.grid[t.y][t.x]=s,this.grid[e.y][e.x]=i,this.solution.push({empty:0===i?t:e,piece:0===i?e:t,number:0===i?s:i})};var p=JSON.parse(localStorage.getItem(\"results\"))||[],b=function(){function t(e,i,s,o){var h=this;!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),g(this,\"startGame\",(function(){h.interval=setInterval((function(){h.CountTime()}),1e3)})),g(this,\"click\",(function(t){if(t.target.closest(\"canvas\")){var e=document.documentElement.clientWidth<=570?300:400,i=Math.floor(t.offsetX/(e/h.width)),s=Math.floor(t.offsetY/(e/h.height));if(h.hole.y===s&&h.hole.x===i?h.movesBlock.textContent=\"Moves \".concat(h.moves):(h.hole.y===s?h.hole.x===i-1?h.toLeft():h.hole.x===i+1&&h.toRight():h.hole.x===i&&(h.hole.y===s-1?h.toUp():h.hole.y===s+1&&h.toDown()),h.movesBlock.textContent=\"Moves \".concat(h.moves+=1)),h.audio){h.audio.currentTime=0;var o=h.audio.play();void 0!==o&&o.then((function(){})).catch((function(t){throw new Error(t)}))}h.ShowVictoryMessage()}})),g(this,\"tick\",(function(){h.view.tick(h.isShuflling),h.render.render(h.view.getState(),h.width),requestAnimationFrame(h.tick)})),g(this,\"autoSolve\",(function(){h.autoSolveBtn.disabled=!0,h.isAutoSolve=!0,h.isShuflling=!h.isShuflling;for(var t=new y(h.state).solve(),e=0;e<t.length;e++)h.hole.y===t[e].empty.y?h.hole.x===t[e].empty.x-1?h.toLeft():h.hole.x===t[e].empty.x+1&&h.toRight():h.hole.x===t[e].empty.x&&(h.hole.y===t[e].empty.y-1?h.toUp():h.hole.y===t[e].empty.y+1&&h.toDown());h.toUp(),clearInterval(h.interval),h.img.classList.remove(\"open\")})),g(this,\"toogleVolume\",(function(){h.isVolume?(h.volumeBlock.style.backgroundImage=\"url('./assets/img/volume-off.svg')\",h.isVolume=!h.isVolume,h.audio.muted=!0):(h.audio.muted=!1,h.volumeBlock.style.backgroundImage=\"url('./assets/img/volume-on.svg')\",h.isVolume=!h.isVolume)})),this.width=e,this.height=i,this.startBtn=s,this.startScreen=o,this.state=[],this.grid=new u(this.width,this.height,400/this.width,400/this.height),this.hole={x:this.width-1,y:this.height-1},this.moves=0,this.sec=0,this.min=0,this.isAutoSolve=!1,this.isShuflling=!0,this.isVolume=!0}var e,i;return e=t,(i=[{key:\"generateState\",value:function(){for(var t=0;t<this.height;t++){for(var e=[],i=0;i<this.width;i++){var s=t*this.width+i+1;s===this.width*this.height&&(s=0),e.push(s)}this.state.push(e)}}},{key:\"getState\",value:function(){return this.state}},{key:\"generateLayout\",value:function(){var t=this;this.canvas=h(\"canvas\",\"canvas\"),this.canvas.width=400,this.canvas.height=400,this.ctx=this.canvas.getContext(\"2d\"),this.main=h(\"div\",\"main\",this.canvas),this.timeBlock=h(\"div\",\"time header__item\",\"Time\",document.body),this.movesBlock=h(\"div\",\"moves header__item\",\"Moves\",document.body),this.newGameBtn=h(\"button\",\"new-game header__item\",\"New game\"),this.resultsCloseBtn=h(\"div\",\"close-btn\",\"x\"),this.resultsHeader=h(\"div\",\"results-header\",[h(\"div\",\"number\",\"№\"),h(\"div\",\"moves\",\"moves\"),h(\"div\",\"date\",\"date\"),h(\"div\",\"size\",\"size\")]),this.results=h(\"div\",\"results\",[this.resultsHeader,this.resultsCloseBtn],this.main),this.resultsList=h(\"div\",\"results-list\"),this.resultBtn=h(\"button\",\"results-btn header__item\",\"Best results\"),this.volumeBlock=h(\"button\",\"volume-btn header__item\",null),this.headerBlock=h(\"header\",\"header\",[this.timeBlock,this.movesBlock,this.newGameBtn,this.resultBtn,this.volumeBlock]),this.victoreMessage=h(\"div\",\"victory\",null,this.main),this.audio=h(\"audio\",\"audio\",null,document.body),this.audio.src=\"./assets/audio/move.ogg\",this.autoSolveBtn=h(\"button\",\"solve-btn\",\"Autosolve\"),this.referenceBtn=h(\"button\",\"reference-btn\",\"Show/hide reference\"),this.options=h(\"div\",\"options\",[this.autoSolveBtn,this.referenceBtn],this.main),document.body.append(this.headerBlock),document.body.append(this.main),document.addEventListener(\"click\",this.click),this.resultBtn.addEventListener(\"click\",(function(){t.results.classList.add(\"active\"),t.printResults()})),this.resultsCloseBtn.addEventListener(\"click\",(function(){t.results.classList.remove(\"active\")})),this.volumeBlock.addEventListener(\"click\",this.toogleVolume),this.autoSolveBtn.addEventListener(\"click\",this.autoSolve),this.referenceBtn.addEventListener(\"click\",(function(){t.img.classList.toggle(\"open\")})),this.newGameBtn.addEventListener(\"click\",(function(){document.body.removeChild(t.headerBlock),document.body.removeChild(t.main),document.body.removeChild(t.audio),t.startScreen.classList.add(\"active\")}))}},{key:\"generateImg\",value:function(){this.img=new Image;var t=Math.floor(149*Math.random()+1);this.img.src=\"./assets/img/box/\".concat(t,\".jpg\"),this.img.classList.add(\"img-reference\"),this.main.appendChild(this.img)}},{key:\"generateRender\",value:function(){this.render=new a(this.ctx,this.grid,this.img)}},{key:\"generateView\",value:function(){this.view=new d(this.getState(),this.width)}},{key:\"CountTime\",value:function(){this.sec=this.sec<59?this.sec+=1:0,0===this.sec&&(this.min+=1),this.timeBlock.textContent=\"Time \".concat(n(this.min),\" : \").concat(n(this.sec))}},{key:\"shufle\",value:function(){this.isShuflling=!1;for(var t=0;t<500;t++){var e=Math.random();e<.25?this.toUp():e<.5?this.toRight():e<.75?this.toDown():this.toLeft()}}},{key:\"isVictory\",value:function(){for(var t=0;t<this.height;t++)for(var e=0;e<this.width;e++){var i=t*this.width+e+1;if(i<this.height*this.width&&this.state[t][e]!==i)return!1}return!0}},{key:\"ShowVictoryMessage\",value:function(){this.isVictory()&&!this.isAutoSolve&&(this.autoSolveBtn.disabled=!0,document.removeEventListener(\"click\",this.click),this.victoreMessage.classList.add(\"active\"),this.victoreMessage.textContent=\"Ура! Вы решили головоломку за \\n        \".concat(\"\".concat(n(this.min),\" : \").concat(n(this.sec)),\" и \",this.moves,\" ходов\"),clearInterval(this.interval),this.setResult())}},{key:\"setResult\",value:function(){if(this.isVictory()){var t={};t.moves=this.moves,t.date=new Date,t.size=\"\".concat(this.width,\"x\").concat(this.width),p.push(t),p.sort((function(t,e){return t.moves-e.moves})),p.length>10&&(p=p.slice(0,10)),localStorage.setItem(\"results\",JSON.stringify(p))}}},{key:\"printResults\",value:function(){var t=this;this.resultsList.innerHTML=\"\";var e=JSON.parse(localStorage.getItem(\"results\"));e&&(e.forEach((function(e,i){var s=h(\"div\",\"result\",[h(\"div\",\"result-number\",\"\".concat(i+1)),h(\"div\",\"result-moves\",\"\".concat(e.moves)),h(\"div\",\"result-date\",\"\".concat(e.date.slice(0,10))),h(\"div\",\"result-date\",\"\".concat(e.size))]);t.resultsList.appendChild(s)})),this.results.appendChild(this.resultsList))}},{key:\"toRight\",value:function(){this.hole.x>0&&(this.state[this.hole.y][this.hole.x]=this.state[this.hole.y][this.hole.x-1],this.state[this.hole.y][this.hole.x-1]=0,this.view.toRight(this.state[this.hole.y][this.hole.x],this.isShuflling),this.hole.x-=1)}},{key:\"toLeft\",value:function(){this.hole.x<this.width-1&&(this.state[this.hole.y][this.hole.x]=this.state[this.hole.y][this.hole.x+1],this.state[this.hole.y][this.hole.x+1]=0,this.view.toLeft(this.state[this.hole.y][this.hole.x],this.isShuflling),this.hole.x+=1)}},{key:\"toDown\",value:function(){this.hole.y>0&&(this.state[this.hole.y][this.hole.x]=this.state[this.hole.y-1][this.hole.x],this.state[this.hole.y-1][this.hole.x]=0,this.view.toDown(this.state[this.hole.y][this.hole.x],this.isShuflling),this.hole.y-=1)}},{key:\"toUp\",value:function(){this.hole.y<this.height-1&&(this.state[this.hole.y][this.hole.x]=this.state[this.hole.y+1][this.hole.x],this.state[this.hole.y+1][this.hole.x]=0,this.view.toUp(this.state[this.hole.y][this.hole.x],this.isShuflling),this.hole.y+=1)}},{key:\"init\",value:function(){this.generateLayout(),this.generateState(),this.generateImg(),this.generateRender(),this.generateView(),this.shufle(),this.tick()}}])&&m(e.prototype,i),t}();new function t(){var e,i,s=this;!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),i=function(){s.startScreen.classList.remove(\"active\");var t=new b(s.width||3,s.height||3,s.startBtn,s.startScreen);t.init(),t.startGame()},(e=\"startNewGame\")in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i,this.select=h(\"select\",\"select\",[h(\"option\",\"select-option\",\"3x3\",this.select,[\"value\",\"3\"]),h(\"option\",\"select-option\",\"4x4\",this.select,[\"value\",\"4\"]),h(\"option\",\"select-option\",\"5x5\",this.select,[\"value\",\"5\"]),h(\"option\",\"select-option\",\"6x6\",this.select,[\"value\",\"6\"]),h(\"option\",\"select-option\",\"7x7\",this.select,[\"value\",\"7\"]),h(\"option\",\"select-option\",\"8x8\",this.select,[\"value\",\"8\"])]),this.games=[],this.startBtn=h(\"button\",\"start-btn\",\"start\"),this.startScreen=h(\"div\",\"start-screen active\",[this.select,this.startBtn]),document.body.prepend(this.startScreen),this.select.addEventListener(\"change\",(function(t){s.width=+t.target.value,s.height=+t.target.value})),this.startBtn.addEventListener(\"click\",this.startNewGame)}})();"],"mappings":"AAAA","sourceRoot":""}